(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=r(e);fetch(e.href,n)}})();class x{grayscale(t){for(let r=0;r<t.data.length;r+=4){const o=t.data[r]*.299+t.data[r+1]*.587+t.data[r+2]*.114;t.data.fill(o,r,r+3)}return t}threshold(t,r){for(let o=0;o<t.data.length;o+=4){const n=t.data[o]*.299+t.data[o+1]*.587+t.data[o+2]*.114<r?0:255;t.data.fill(n,o,o+3)}return t}bayer(t,r){const o=[[15,135,45,165],[195,75,225,105],[60,180,30,150],[240,120,210,90]];for(let e=0;e<t.data.length;e+=4){const n=t.data[e]*.299+t.data[e+1]*.587+t.data[e+2]*.114,s=e/4%t.width,i=Math.floor(e/4/t.width),S=Math.floor((n+o[s%4][i%4])/2)<r?0:255;t.data.fill(S,e,e+3)}return t}floydsteinberg(t){const r=t.width,o=new Uint8ClampedArray(t.width*t.height);for(let e=0,n=0;n<t.data.length;e++,n+=4)o[e]=t.data[n]*.299+t.data[n+1]*.587+t.data[n+2]*.114;for(let e=0,n=0;n<t.data.length;e++,n+=4){const s=o[e]<129?0:255,i=Math.floor((o[e]-s)/16);t.data.fill(s,n,n+3),o[e+1]+=i*7,o[e+r-1]+=i*3,o[e+r]+=i*5,o[e+r+1]+=i*1}return t}atkinson(t){const r=t.width,o=new Uint8ClampedArray(t.width*t.height);for(let e=0,n=0;n<t.data.length;e++,n+=4)o[e]=t.data[n]*.299+t.data[n+1]*.587+t.data[n+2]*.114;for(let e=0,n=0;n<t.data.length;e++,n+=4){const s=o[e]<129?0:255,i=Math.floor((o[e]-s)/8);t.data.fill(s,n,n+3),o[e+1]+=i,o[e+2]+=i,o[e+r-1]+=i,o[e+r]+=i,o[e+r+1]+=i,o[e+2*r]+=i}return t}}var v=new x;const p=512,M=p/(4/3);let u=null,a=null,d=null,f=!0,w=!1,g=!1,E=!1,y=0,m=!1,O="floydsteinberg",b=100;const h=document.getElementsByName("dithertype"),I=document.getElementById("bayerthreshold");for(let c=0;c<h.length;c++)h[c].value=="bayer"?h[c].addEventListener("change",function(){I.innerHTML=`
      <input type="range" min="1" max="255" id="bayerrange" value=`+b+`>
      <h3>threshold</h3>
      `,document.getElementById("bayerrange").addEventListener("input",function(){b=this.value}),console.log("bayeron")}):h[c].addEventListener("change",function(){I.innerHTML="",console.log("bayeroff")}),h[c].addEventListener("click",function(){O=this.value});const A=document.getElementById("flipped");A.addEventListener("change",function(){l.translate(p,0),l.scale(-1,1)});const P=document.getElementById("color1"),D=document.getElementById("color2"),B=document.getElementById("customcolor");P.addEventListener("change",function(){B.innerHTML="",w=!1});D.addEventListener("change",function(){B.innerHTML=`
  <input type="color" id="colorselector" name="colorselector" value ="#cc0000">
  `,w=!0,l.fillStyle="#cc0000";const c=document.getElementById("colorselector");c.addEventListener("change",function(){l.fillStyle=c.value})});u=document.querySelector("video");navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(c=>{u.srcObject=c,u.play}).catch(c=>{console.error("could not get webcam")});u.setAttribute("width",p);u.setAttribute("height",M);a=document.querySelector("canvas");a.width=p;a.height=M;const H=document.getElementById("3sec");H.addEventListener("change",function(){g=!g});a.addEventListener("click",function(){m||(g&&f?(m=!0,E=!0,setTimeout(function(){C()},3e3)):k())});const T=document.getElementById("instructions");function k(){f=!f,f?T.innerHTML="click to take photo":T.innerHTML="right click to save or copy",L()}function C(){k(),m=!1,E=!1,y=0}const l=a.getContext("2d");l.font="30px Inter";l.drawImage(u,0,0,a.width,a.height);u.addEventListener("play",function(){l.drawImage(this,0,0,a.width,a.height)},!1);function L(){switch(f&&requestAnimationFrame(L),l.drawImage(u,0,0,a.width,a.height),d=l.getImageData(0,0,a.width,a.height),O){case"atkinson":d=v.atkinson(d);break;case"bayer":d=v.bayer(d,b);break;case"floydsteinberg":d=v.floydsteinberg(d);break}l.putImageData(d,0,0),w&&(l.globalAlpha=.5,l.fillRect(0,0,a.width,a.height),l.globalAlpha=1),E&&(y+=1,y<60?l.fillText("ðŸ•’",30,50):y<120?l.fillText("ðŸ••",30,50):l.fillText("ðŸ•˜",30,50))}L();
